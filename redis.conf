# ===== Redis 영속성 설정 =====

# RDB 스냅샷 저장 조건 (Default)
save 900 1
save 300 10
save 60 10000

# RDB 설정
dbfilename dump.rdb                # RDB 파일명
rdbcompression yes                 # RDB 파일 압축 활성화 (디스크 절약)
rdbchecksum yes                    # 파일 무결성 체크섬 활성화 (손상 감지)
stop-writes-on-bgsave-error no     # RDB 저장 실패 시에도 쓰기 작업 계속 (가용성 우선)

# AOF 설정
appendonly yes                     # AOF 활성화
appendfilename "appendonly.aof"    # AOF 파일명
appendfsync everysec               # 매초마다 디스크에 fsync (최대 1초 데이터 손실)
auto-aof-rewrite-percentage 100    # AOF 파일이 이전 크기의 2배가 되면 재작성
auto-aof-rewrite-min-size 64mb     # AOF 재작성 최소 크기 (64MB 이상일 때만)
aof-load-truncated yes             # 손상된 AOF 끝부분 무시하고 로드 (빠른 복구)

# 데이터 디렉토리
dir /data                          # RDB/AOF 파일 저장 경로

# 메모리 설정
maxmemory 512mb                    # 최대 메모리 사용량 제한
maxmemory-policy allkeys-lru       # 메모리 부족 시 가장 오래 사용 안 한 키 삭제